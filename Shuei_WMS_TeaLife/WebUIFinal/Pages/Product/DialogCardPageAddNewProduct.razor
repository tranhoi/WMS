@page "/addproduct/{Title}"
@using Application.DTOs.Request.Products
@using Application.Extentions
@using Domain.Enums
@using Domain.Entity.Commons
@using ProductModel = Domain.Entity.Commons.Product
@using Microsoft.AspNetCore.Authorization
@using ProductJanCode = Domain.Entity.Commons.ProductJanCode
@using WebUIFinal.Core

@inject IStringLocalizer<CommonResources> _localizer
@inject IStringLocalizer<CurrencyResources> _localizerCurrency

<style>
    .input-image-container {
        display: flex;
        align-items: center;
    }

    .image-container {
        position: relative;
        display: inline-block;
        margin-left: 10px;
    }

    .img-thumbnail {
        border-radius: 4px;
        height: 102px;
        width: 102px;
    }

    .overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .image-container:hover .overlay {
        opacity: 0.6;
    }

    .icon {
        color: white;
        font-size: 24px;
    }

    .fa-times:hover {
        color: #eee;
        cursor: pointer;
    }

    .hidden-input input[type="file"] {
        display: none; /* Ẩn thẻ InputFile mặc định */
    }
</style>

@attribute [Authorize(Policy = "Admin")]
@if (model == null || (!Title.Contains(_localizer["Detail.Create"]) && string.IsNullOrEmpty(model.ProductCode))
                || _currencyList == null || _currencyList.Count <= 0)
{
    <p><em>@_localizer["Loading"]...</em></p>
}
else
{
    <RadzenRow>
        <RadzenColumn Size="12" SizeSM="12">
            <RadzenLink Text="@_localizer["Detail.BackToList"]" Path="/productlist" Icon="arrow_back_ios" Style="margin-bottom: 1rem;" />
        </RadzenColumn>
    </RadzenRow>
    <RadzenTabs />
    <RadzenRow>
        <RadzenColumn Size="12" SizeSM="6">
            <RadzenText TextStyle="TextStyle.Body1"><strong>@_localizer["Create"] @_localizer["Product"]</strong></RadzenText>
        </RadzenColumn>
        @if (!Title.Contains("Create"))
        {
            <RadzenColumn Size="12" SizeSM="6">
                <RadzenStack Orientation="Radzen.Orientation.Horizontal" JustifyContent="Radzen.JustifyContent.End" AlignItems="AlignItems.Center" Gap=" 5px">
                    <RadzenButton Click=@(args => DeleteItemAsync(model)) Variant="Variant.Flat" Shade="Shade.Dark"
                                  Text="@_localizer["Delete"]" Icon="cancel" ButtonStyle="ButtonStyle.Danger" />
                </RadzenStack>
            </RadzenColumn>
        }
    </RadzenRow>
    <RadzenTemplateForm Data="@model" Submit="@((ProductModel args) => {Submit(args);})">
        <RadzenRow Gap="2rem" class="rz-p-0 rz-p-lg-4">
            <RadzenColumn Size="12" SizeMD="12">
                <RadzenFieldset Text="@_localizer["Product.Info"]" Disabled="@isDisabled">
                    <RadzenStack Gap="5px">
                        <RadzenRow AlignItems="AlignItems.Center" class="mt-3">
                            <RadzenColumn SizeXS="12" SizeSM="6">
                                <RadzenFormField Text="@_localizer["Product.Code"]" Variant="Variant.Outlined" Style="display:flex;flex-direction:column;align-items:stretch;width:100%">
                                    <RadzenTextBox Name="_txtProductCode" @bind-Value="@model.ProductCode" @onchange="@(args => model.ProductCode = args.Value.ToString())" Placeholder="@_localizer["Typing ..."]" />
                                </RadzenFormField>
                                <RadzenRequiredValidator Component="_txtProductCode" Popup="false" Style="position: absolute" />
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="6">
                                <RadzenFormField RadzenFormField Text="@_localizer["Supplier.Code"]" Variant="Variant.Outlined" Style="display:flex;flex-direction:column;align-items:stretch;width:100%">
                                    <RadzenDropDown TValue="int" Name="_dropDownSupplier" @bind-Value="@model.SupplierId" Data="@suppliers"
                                                    Multiple=false AllowClear=true Placeholder="@_localizer["Select"]" Chips=true Disabled="@isDisabled"
                                                    TextProperty="SupplierName" ValueProperty="Id" />
                                </RadzenFormField>
                                <RadzenRequiredValidator Component="_dropDownSupplier" Popup="false" Style="position: absolute" />
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="6">
                                <RadzenFormField Text="@_localizer["Product.ShortCode"]" Variant="Variant.Outlined" Style="display:flex;flex-direction:column;align-items:stretch;width:100%">
                                    <RadzenTextBox Name="_txtProductShortCode" @bind-Value="@model.ProductShortCode" Placeholder="@_localizer["Typing ..."]" />
                                </RadzenFormField>
                                <RadzenRequiredValidator Component="_txtProductShortCode" Popup="false" Style="position: absolute" />
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="6">
                                <RadzenFormField Text="@_localizer["Product.MaxShipDays"]" Variant="Variant.Outlined" Style="width: 100%;">
                                    <RadzenNumeric TValue="int" Name="_txtShippingLimitDays" @bind-Value="@model.ShippingLimitDays" Placeholder="@_localizer["Typing ..."]" />
                                </RadzenFormField>
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="6">
                                <RadzenFormField Text="@_localizer["Product.Name"]" Variant="Variant.Outlined" Style="display:flex;flex-direction:column;align-items:stretch;width:100%">
                                    <RadzenTextBox Name="_txtProductName" @bind-Value="@model.ProductName" Placeholder="@_localizer["Typing ..."]" />
                                </RadzenFormField>
                                <RadzenRequiredValidator Component="_txtProductName" Popup="false" Style="position: absolute" />
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="6">
                                <RadzenFormField Text="@_localizer["Product.MfgCode"]" Variant="Variant.Outlined" Style="display:flex;flex-direction:column;align-items:stretch;width:100%">
                                    <RadzenTextBox Name="_txtMakerManagementCode" @bind-Value="@model.MakerManagementCode" Placeholder="@_localizer["Typing ..."]" />
                                </RadzenFormField>
                                @* <RadzenRequiredValidator Component="_txtMakerManagementCode" Popup="false" Style="position: absolute" /> *@
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="6">
                                <RadzenFormField Text="@_localizer["Category"]" Variant="Variant.Outlined" Style="display:flex;flex-direction:column;align-items:stretch;width:100%">
                                    <RadzenDropDown @bind-Value="@model.CategoryId" Data=@productCategories Name="_dropDownCategory"
                                                    Multiple=false AllowClear=true Placeholder="@_localizer["Select"]" Chips=true Disabled="@isDisabled"
                                                    TextProperty="CategoryName" ValueProperty="Id" />
                                </RadzenFormField>
                                <RadzenRequiredValidator Component="_dropDownCategory" Popup="false" Style="position: absolute" />
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="6">
                                <RadzenFormField Text="@_localizer["Weight"]" Variant="Variant.Outlined" Style="display:flex;flex-direction:column;align-items:stretch;width:100%">
                                    <RadzenNumeric TValue="double?" Name="_txtWeight" @bind-Value="@model.Weight" Placeholder="@_localizer["Typing ..."]" />
                                </RadzenFormField>
                                @* <RadzenRequiredValidator Component="_txtWeight" Popup="false" Style="position: absolute" /> *@
                            </RadzenColumn>

                            <RadzenColumn SizeXS="12" SizeSM="6">
                                <RadzenFormField Text="@_localizer["Depth"]" Variant="Variant.Outlined" Style="display:flex;flex-direction:column;align-items:stretch;width:100%">
                                    <RadzenNumeric TValue="double?" Name="_txtDepth" @bind-Value="@model.Depth" Placeholder="@_localizer["Typing ..."]" />
                                </RadzenFormField>
                                @* <RadzenRequiredValidator Component="_txtDepth" Popup="false" Style="position: absolute" /> *@
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="6">
                                <RadzenFormField Text="@_localizer["Width"]" Variant="Variant.Outlined" Style="display:flex;flex-direction:column;align-items:stretch;width:100%">
                                    <RadzenNumeric TValue="double?" Name="_txtWidth" @bind-Value="@model.Width" Placeholder="@_localizer["Typing ..."]" />
                                </RadzenFormField>
                                @* <RadzenRequiredValidator Component="_txtWidth" Popup="false" Style="position: absolute" /> *@
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="6">
                                <RadzenFormField Text="@_localizer["Height"]" Variant="Variant.Outlined" Style="display:flex;flex-direction:column;align-items:stretch;width:100%">
                                    <RadzenNumeric TValue="double?" Name="_txtHeight" @bind-Value="@model.Height" Placeholder="@_localizer["Typing ..."]" />
                                </RadzenFormField>
                                @* <RadzenRequiredValidator Component="_txtHeight" Popup="false" Style="position: absolute" /> *@
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="6">
                                <RadzenFormField Text="@_localizer["Unit"]" Variant="Variant.Outlined" Style="display:flex;flex-direction:column;align-items:stretch;width:100%">
                                    <RadzenDropDown TValue="int" @bind-Value=@model.UnitId Data="@units" TextProperty="UnitName" ValueProperty="Id" Name="_dropDownUnit"
                                                    Multiple=false AllowClear=true Placeholder="@_localizer["Select"]" Chips=true Disabled="@isDisabled" />
                                </RadzenFormField>
                                <RadzenRequiredValidator Component="_dropDownUnit" Popup="false" Style="position: absolute" />
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="6">
                                <RadzenFormField Text="@_localizer["Currency"]" Variant="Variant.Outlined" Style="display:flex;flex-direction:column;align-items:stretch;width:100%">
                                    <RadzenDropDownDataGrid @bind-Value=@_selectedCurrency Data=@_currencyList TextProperty="@nameof(Currency.CurrencyCode)"
                                                            AllowColumnResize="true" AllowFilteringByAllStringColumns="true" Name="_dropDownSelectCurrency"
                                                            SearchTextPlaceholder="@_localizer["Search"]" EmptyText="@_localizer["No records to display."]" Disabled="@isDisabled">
                                        <Columns>
                                            <RadzenDropDownDataGridColumn Property="@nameof(Currency.CurrencyCode)" Title="@_localizerCurrency["Currency Code"]" Width="50px" />
                                            <RadzenDropDownDataGridColumn Property="@nameof(Currency.Country)" Title="@_localizerCurrency["Country"]" Width="50px" />
                                            <RadzenDropDownDataGridColumn Property="@nameof(Currency.Description)" Title="@_localizer["Description"]" Width="50px" />
                                        </Columns>
                                    </RadzenDropDownDataGrid>
                                </RadzenFormField>
                                <RadzenRequiredValidator Component="_dropDownSelectCurrency" Popup="false" Style="position: absolute" />
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="6">
                                <RadzenFormField Text="@_localizer["Product.StandardPrice"]" Variant="Variant.Outlined" Style="display:flex;flex-direction:column;align-items:stretch;width:100%">
                                    <RadzenNumeric TValue="double?" Name="_txtStandardPrice" @bind-Value="@model.StandardPrice" Placeholder="@_localizer["Typing ..."]" />
                                </RadzenFormField>
                                <RadzenRequiredValidator Component="_txtStandardPrice" Popup="false" Style="position: absolute" />
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="6">
                                <RadzenFormField Text="@_localizer["Product.Type"]" Variant="Variant.Outlined" Style="display:flex;flex-direction:column;align-items:stretch;width:100%">
                                    <RadzenDropDown @bind-Value="@selectedProductType" Data=@GetDisplayProductType() Name="_dropDownProductType"
                                                    Multiple=false AllowClear=true Placeholder="@_localizer["Select"]" Chips=true Disabled="@isDisabled"
                                                    TextProperty="DisplayValue" ValueProperty="Value" />
                                </RadzenFormField>
                                <RadzenRequiredValidator Component="_dropDownProductType" Popup="false" Style="position: absolute" />
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="6">
                                <RadzenFormField Text="@_localizer["Product.URL"]" Variant="Variant.Outlined" Style="display:flex;flex-direction:column;align-items:stretch;width:100%">
                                    <RadzenTextBox Name="_txtProductUrl" @bind-Value="@model.ProductUrl" Placeholder="@_localizer["Typing ..."]" />
                                </RadzenFormField>
                                @* <RadzenRequiredValidator Component="_txtProductUrl" Popup="false" Style="position: absolute" /> *@
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="6">
                                <RadzenFormField Text="@_localizer["Status"]" Variant="Variant.Outlined" Style="display:flex;flex-direction:column;align-items:stretch;width:100%">
                                    <RadzenDropDown @bind-Value="@selectedStatus" Data=@(Enum.GetValues(typeof(EnumProductStatus)).Cast<Enum>()) Name="_dropDownProductStatus"
                                                    Multiple=false AllowClear=true Placeholder="Select product status" Chips=true Disabled="@isDisabled" />
                                </RadzenFormField>
                                <RadzenRequiredValidator Component="_dropDownProductStatus" Popup="false" Style="position: absolute" />
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="6" style="margin-top: 5px;">
                                <RadzenLabel Text="@_localizer["Product.WmsProcessingFlag"]" Component="CheckBox1" class="rz-ms-2" />
                                <RadzenCheckBox @bind-Value="@model.WarehouseProcessingFlag" Name="WarehouseProcessingFlag" Disabled="@isDisabled" />
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="12">
                                <RadzenFieldset Text="@_localizer["Product image"]">
                                    <RadzenStack AlignItems="AlignItems.Center">
                                        <RadzenCard class="rz-m-0 rz-m-md-0" Style="width: 100%;" Variant="Variant.Filled">
                                            @if (!Title.Contains(_localizer["Detail.View"]))
                                            {
                                                <RadzenFileInput @bind-Value=@imageBase64String @bind-FileName=@fileName @bind-FileSize=@fileSize TValue="string"
                                                                 Style="width: 100%" ChooseText="@_localizer["Choose file"]"
                                                                 Change=@(args => OnChange(args, "FileInput")) Error=@(args => OnError(args, "FileInput"))
                                                                 InputAttributes="@(new Dictionary<string,object>(){ { "aria-label", "select file" }})" />
                                            }
                                            else
                                            {
                                                <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.Center"
                                                             AlignItems="AlignItems.Center" Gap="5px" Wrap="FlexWrap.Wrap">
                                                    <RadzenImage Path="@imageBase64String" AlternateText="base64 image" Style="width: 15rem" />
                                                    <RadzenText TextStyle="TextStyle.Body1"><b>@fileName</b></RadzenText>
                                                </RadzenStack>
                                            }
                                        </RadzenCard>
                                    </RadzenStack>
                                </RadzenFieldset>
                            </RadzenColumn>
                        </RadzenRow>
                    </RadzenStack>
                </RadzenFieldset>
            </RadzenColumn>
        </RadzenRow>
        <RadzenRow Gap="2rem" class="rz-p-0 rz-p-lg-4">
            <RadzenColumn Size="12" SizeMD="12">
                <RadzenFieldset Text="@_localizer["Tenant.Info"]" Disabled="@isDisabled">
                    <RadzenStack Gap="5px">
                        <RadzenRow AlignItems="AlignItems.Center">
                            <RadzenColumn SizeXS="12" SizeSM="6">
                                <RadzenFormField Text="@_localizer["Tenant"]" Variant="Variant.Outlined" Style="display:flex;flex-direction:column;align-items:stretch;width:100%">
                                    <RadzenDropDown @bind-Value="@model.TenantId" TValue="int?" Data="@tenants" TextProperty="TenantFullName" ValueProperty="TenantId" Name="_dropDownTenant"
                                                    Multiple=false AllowClear=true Placeholder="@_localizer["Select"]" Chips=true Disabled="@isDisabled" />
                                </RadzenFormField>
                                <RadzenRequiredValidator Component="_dropDownTenant" Popup="false" Style="position: absolute" />
                            </RadzenColumn>
                        </RadzenRow>
                    </RadzenStack>
                </RadzenFieldset>
            </RadzenColumn>
        </RadzenRow>
        <RadzenRow Gap="2rem" class="rz-p-0 rz-p-lg-4">
            <RadzenColumn Size="12" SizeMD="12">
                <RadzenFieldset Text="@_localizer["Product.StockInfo"]" Disabled>
                    <RadzenStack Gap="5px">
                        <RadzenRow AlignItems="AlignItems.Center">
                            <RadzenColumn SizeXS="12" SizeSM="4">
                                <RadzenFormField Text="@_localizer["Product.StockQty"]" Variant="Variant.Outlined" Style="width: 100%;">
                                    <RadzenNumeric TValue="int" @bind-Value="@model.StockAvailableQuanitty" Name="_txtStockQuantity" Placeholder="@_localizer["Typing ..."]" />
                                </RadzenFormField>
                                <RadzenRequiredValidator Component="_txtStockQuantity" Popup="false" Style="position: absolute" />
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="4">
                                <RadzenFormField Text="@_localizer["Product.OrderQty"]" Variant="Variant.Outlined" Style="width: 100%;">
                                    <RadzenNumeric TValue="int" @bind-Value="@shippingQuantity" Name="_txtOrderQuantity" Placeholder="@_localizer["Typing ..."]" />
                                </RadzenFormField>
                                <RadzenRequiredValidator Component="_txtOrderQuantity" Popup="false" Style="position: absolute" />
                            </RadzenColumn>
                            <RadzenColumn SizeXS="12" SizeSM="4">
                                <RadzenFormField Text="@_localizer["Product.ShipQty"]" Variant="Variant.Outlined" Style="width: 100%;">
                                    <RadzenNumeric TValue="int" @bind-Value="@orderQuantity" Name="_txtShippingQuantity" Placeholder="@_localizer["Typing ..."]" />
                                    <RadzenRequiredValidator Component="_txtShippingQuantity" Popup="false" Style="position: absolute" />
                                </RadzenFormField>
                            </RadzenColumn>
                        </RadzenRow>
                    </RadzenStack>
                </RadzenFieldset>
            </RadzenColumn>
        </RadzenRow>
        <RadzenRow Gap="2rem" class="rz-p-0 rz-p-lg-4">
            <RadzenColumn Size="12" SizeMD="12">
                <RadzenFieldset Text="@_localizer["Product.JanCode"]">
                    <RadzenStack Orientation=Orientation.Vertical JustifyContent="JustifyContent.Center" AlignItems="AlignItems.Stretch" Gap="5px">
                        <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.End" AlignItems="AlignItems.Center" Gap=" 5px">
                            <RadzenButton Click=@(args => AddProductJanCode()) Variant="Variant.Flat" Shade="Shade.Dark"
                                          Text="@_localizer["Detail.Create"]" Icon="add_circle" ButtonStyle="ButtonStyle.Success" Disabled="@isDisabled" />
                        </RadzenStack>
                        <RadzenDataGrid @ref="_productJanCodeProfileGrid" Data="@productJanCodes" TItem="ProductJanCode" AllowFiltering="true" class="custom-grid"
                                        FilterPopupRenderMode="PopupRenderMode.OnDemand" AllowPaging="true" PageSize="5" PageSizeText="@_localizer["items per page"]" AllowSorting="true"
                                        AllowColumnPicking="false" AllowColumnResize="true" AllowGrouping="false" EmptyText="@_localizer["No records to display."]"
                                        GridLines="Radzen.DataGridGridLines.Both" AllowAlternatingRows="false"
                                        ShowPagingSummary=@_showPagerSummary PagingSummaryFormat="@Constants.PagingSummaryFormat" PageSizeOptions="@Constants.PageSizeOptions"
                                        AllowRowSelectOnRowClick="@allowRowSelectOnRowClick" FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive"
                                        SelectionMode="DataGridSelectionMode.Multiple" Disabled="@isDisabled">
                            <Columns>
                                <RadzenDataGridColumn TItem="ProductJanCode" Filterable="false" TextAlign="TextAlign.Center" Visible="@_visibleBtnSubmit"
                                                      Frozen="true" FrozenPosition="FrozenColumnPosition.Left" Width="170px">
                                    <HeaderTemplate>
                                        <RadzenText Text="@_localizer["Action"]" />
                                    </HeaderTemplate>
                                    <Template Context="data">
                                        <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.Center" AlignItems="AlignItems.Center" Gap="2px" Wrap="FlexWrap.Wrap">
                                            <RadzenButton ButtonStyle="ButtonStyle.Light" Icon="visibility" Variant="Variant.Flat" Shade="Shade.Lighter"
                                                          Size="ButtonSize.Medium" class="my-1 ms-1" Click="@(args => ViewJanCodeItemAsync(data))"
                                                          @onclick:stopPropagation="true" />
                                            <RadzenButton ButtonStyle="ButtonStyle.Light" Icon="edit" Variant="Variant.Flat" Shade="Shade.Lighter"
                                                          Size="ButtonSize.Medium" class="my-1 ms-1" Click="@(args => EditJanCodeItemAsync(data))"
                                                          @onclick:stopPropagation="true" />
                                            <RadzenButton ButtonStyle="ButtonStyle.Danger" Icon="delete" Variant="Variant.Flat" Shade="Shade.Lighter"
                                                          Size="ButtonSize.Medium" class="my-1 ms-1"
                                                          Click="@(args => DeleteJanCodeItemAsync(data))"
                                                          @onclick:stopPropagation="true" />
                                        </RadzenStack>
                                    </Template>
                                </RadzenDataGridColumn>
                                <RadzenDataGridColumn TItem="ProductJanCode" Width="200px" Property="JanCode" Title="JAN" />
                                <RadzenDataGridColumn TItem="ProductJanCode" Width="200px" Property="JanDescription" Title="@_localizer["Description"]" />
                                <RadzenDataGridColumn TItem="ProductJanCode" Width="200px" Property="Status" Title="@_localizer["Status"]" />
                            </Columns>
                        </RadzenDataGrid>

                    </RadzenStack>
                </RadzenFieldset>
            </RadzenColumn>
        </RadzenRow>

        <RadzenStack Orientation="Radzen.Orientation.Horizontal" JustifyContent="Radzen.JustifyContent.Center" Gap="1rem" Class="rz-mt-8 rz-mb-4">
            @if (!isDisabled)
            {
                <RadzenButton Click=@(_ => _navigation.NavigateTo("/productlist")) Style="background-color:cadetblue" Size="ButtonSize.Large" Icon="cancel" Text="@_localizer["Cancel"]" />
                <RadzenButton ButtonType="Radzen.ButtonType.Submit" Size="ButtonSize.Large" Icon="save" Text="@_localizer["Save"]" />
            }
            else
            {
                <RadzenButton Click=@(_ => _navigation.NavigateTo("/productlist")) Style="background-color:cadetblue" Size="ButtonSize.Large" Icon="cancel" Text="@_localizer["Cancel"]" />
                <RadzenButton Click=@(_ => _navigation.NavigateTo($"/addproduct/Edit Product|{model.Id}", true)) ButtonType="Radzen.ButtonType.Button" Size="ButtonSize.Large" Icon="edit" Text="@_localizer["Edit"]" />
            }
        </RadzenStack>
    </RadzenTemplateForm>
}

@code {
    //string photo = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIyLjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgNTAgNTAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDUwIDUwOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8ZyBpZD0iTGF5ZXJfMSI+DQoJPHBhdGggZD0iTTI1LDFDMTEuNzY3LDEsMSwxMS43NjcsMSwyNWMwLDcuMDkxLDMuMDk0LDEzLjQ3Miw4LDE3Ljg2OXYwLjAxN2wwLjM0OCwwLjNjMC4wNjEsMC4wNTMsMC4xMjgsMC4wOTcsMC4xOSwwLjE0OQ0KCQljMC40MzEsMC4zNjQsMC44NzUsMC43MTMsMS4zMzEsMS4wNDdjMC4xMjMsMC4wOSwwLjI0NiwwLjE3NywwLjM3MSwwLjI2NGMwLjQ4NCwwLjM0LDAuOTc5LDAuNjY0LDEuNDg3LDAuOTY4DQoJCWMwLjA4NSwwLjA1MSwwLjE3MiwwLjA5OSwwLjI1NywwLjE0OGMwLjU1NywwLjMyNCwxLjEyNiwwLjYyOSwxLjcxLDAuOTA4YzAuMDA2LDAuMDAzLDAuMDEyLDAuMDA1LDAuMDE4LDAuMDA4DQoJCWMxLjI0OSwwLjU5NSwyLjU1OSwxLjA4MiwzLjkxNSwxLjQ1NmMwLjAyNSwwLjAwNywwLjA1LDAuMDE1LDAuMDc1LDAuMDIxYzAuNjQxLDAuMTc1LDEuMjkzLDAuMzIyLDEuOTU0LDAuNDQzDQoJCWMwLjA2MiwwLjAxMSwwLjEyMywwLjAyMiwwLjE4NSwwLjAzM2MwLjYzOCwwLjExMiwxLjI4NCwwLjIwMSwxLjkzOSwwLjI2MmMwLjA3NSwwLjAwNywwLjE1LDAuMDExLDAuMjI0LDAuMDE3DQoJCUMyMy42NjMsNDguOTY1LDI0LjMyNyw0OSwyNSw0OXMxLjMzNy0wLjAzNSwxLjk5Ni0wLjA5YzAuMDc1LTAuMDA2LDAuMTUtMC4wMSwwLjIyNC0wLjAxN2MwLjY1NS0wLjA2LDEuMzAxLTAuMTUsMS45MzktMC4yNjINCgkJYzAuMDYyLTAuMDExLDAuMTIzLTAuMDIyLDAuMTg1LTAuMDMzYzAuNjYxLTAuMTIxLDEuMzEzLTAuMjY4LDEuOTU0LTAuNDQzYzAuMDI1LTAuMDA3LDAuMDUtMC4wMTQsMC4wNzUtMC4wMjENCgkJYzEuMzU2LTAuMzc0LDIuNjY2LTAuODYxLDMuOTE1LTEuNDU2YzAuMDA2LTAuMDAzLDAuMDEyLTAuMDA1LDAuMDE4LTAuMDA4YzAuNTg0LTAuMjc5LDEuMTUzLTAuNTg1LDEuNzEtMC45MDgNCgkJYzAuMDg2LTAuMDUsMC4xNzItMC4wOTcsMC4yNTctMC4xNDhjMC41MDktMC4zMDQsMS4wMDQtMC42MjksMS40ODctMC45NjhjMC4xMjQtMC4wODcsMC4yNDgtMC4xNzQsMC4zNzEtMC4yNjQNCgkJYzAuNDU2LTAuMzM0LDAuOS0wLjY4MywxLjMzMS0xLjA0N2MwLjA2Mi0wLjA1MiwwLjEyOS0wLjA5NiwwLjE5LTAuMTQ5bDAuMzQ4LTAuM3YtMC4wMTdjNC45MDYtNC4zOTgsOC0xMC43NzgsOC0xNy44NjkNCgkJQzQ5LDExLjc2NywzOC4yMzMsMSwyNSwxeiBNMjUsMjVjLTQuNDExLDAtOC0zLjU4OS04LThzMy41ODktOCw4LThzOCwzLjU4OSw4LDhTMjkuNDExLDI1LDI1LDI1eiBNMjgsMjdjNi4wNjUsMCwxMSw0LjkzNSwxMSwxMQ0KCQl2My45NThjLTAuMDQyLDAuMDM1LTAuMDg2LDAuMDY3LTAuMTI4LDAuMTAyYy0wLjM5NSwwLjMyMS0wLjgsMC42MjYtMS4yMTQsMC45MThjLTAuMDkyLDAuMDY1LTAuMTgyLDAuMTMyLTAuMjc0LDAuMTk1DQoJCWMtMC40NDcsMC4zMDUtMC45MDYsMC41OTEtMS4zNzMsMC44NjJjLTAuMDg1LDAuMDUtMC4xNzEsMC4wOTktMC4yNTcsMC4xNDhjLTAuNDksMC4yNzUtMC45ODksMC41MzMtMS40OTgsMC43NjkNCgkJYy0wLjA1MywwLjAyNS0wLjEwNywwLjA0OS0wLjE2MSwwLjA3M2MtMS42NjEsMC43NTUtMy40MTEsMS4zMDItNS4yMTIsMS42MjZjLTAuMDU3LDAuMDEtMC4xMTQsMC4wMjEtMC4xNzEsMC4wMzENCgkJYy0wLjU2NywwLjA5Ny0xLjEzOSwwLjE3Mi0xLjcxNSwwLjIyNWMtMC4wNzksMC4wMDctMC4xNTksMC4wMTItMC4yMzksMC4wMThDMjYuMTc1LDQ2Ljk3LDI1LjU4OSw0NywyNSw0Nw0KCQlzLTEuMTc1LTAuMDMtMS43NTgtMC4wNzdjLTAuMDc5LTAuMDA2LTAuMTU5LTAuMDExLTAuMjM5LTAuMDE4Yy0wLjU3Ni0wLjA1My0xLjE0OC0wLjEyNy0xLjcxNS0wLjIyNQ0KCQljLTAuMDU3LTAuMDEtMC4xMTQtMC4wMi0wLjE3MS0wLjAzMWMtMS44MDEtMC4zMjQtMy41NTEtMC44NzEtNS4yMTItMS42MjZjLTAuMDU0LTAuMDI1LTAuMTA4LTAuMDQ4LTAuMTYxLTAuMDczDQoJCWMtMC41MDktMC4yMzYtMS4wMDgtMC40OTQtMS40OTgtMC43NjljLTAuMDg2LTAuMDQ5LTAuMTcxLTAuMDk4LTAuMjU3LTAuMTQ4Yy0wLjQ2Ny0wLjI3LTAuOTI2LTAuNTU3LTEuMzczLTAuODYyDQoJCWMtMC4wOTMtMC4wNjMtMC4xODMtMC4xMy0wLjI3NC0wLjE5NWMtMC40MTQtMC4yOTItMC44MTktMC41OTYtMS4yMTQtMC45MThjLTAuMDQyLTAuMDM0LTAuMDg2LTAuMDY3LTAuMTI4LTAuMTAyVjM4DQoJCWMwLTYuMDY1LDQuOTM1LTExLDExLTExSDI4eiBNNDEsNDAuMDc2VjM4YzAtNi4yNzEtNC40NjQtMTEuNTE5LTEwLjM4LTEyLjczNUMzMy4yNjEsMjMuNDY0LDM1LDIwLjQzMSwzNSwxNw0KCQljMC01LjUxNC00LjQ4Ni0xMC0xMC0xMHMtMTAsNC40ODYtMTAsMTBjMCwzLjQzMSwxLjczOSw2LjQ2NCw0LjM4LDguMjY1QzEzLjQ2NCwyNi40ODEsOSwzMS43MjksOSwzOHYyLjA3Ng0KCQlDNS4yODQsMzYuMTM1LDMsMzAuODMxLDMsMjVDMywxMi44NjksMTIuODY5LDMsMjUsM3MyMiw5Ljg2OSwyMiwyMkM0NywzMC44MzEsNDQuNzE2LDM2LjEzNSw0MSw0MC4wNzZ6Ii8+DQo8L2c+DQo8Zz4NCjwvZz4NCjwvc3ZnPg0K";
    //string img = "data:image/svg+xml;base64,";

    string fileName;
    long? fileSize;

    async void OnChange(string value, string name)
    {
        if (string.IsNullOrEmpty(value)) return;

        // Console.WriteLine($"{name} value changed");

        if (string.IsNullOrEmpty(model.ProductCode))
        {
            _notificationService.Notify(new NotificationMessage()
                {
                    Severity = NotificationSeverity.Error,
                    Summary = "Error",
                    Detail = $"The product code is required to upload image. Please enter the product code !",
                    Duration = 5000
                });

            return;
        }

        // Only handle image files
        if (!value.Contains("base64"))
        {
            _notificationService.Notify(new NotificationMessage()
                {
                    Severity = NotificationSeverity.Error,
                    Summary = "Error",
                    Detail = $"Select images only!",
                    Duration = 5000
                });

            return;
        }

        imageBase64String = value;
        _isChooseImage = true;
    }

    void OnError(UploadErrorEventArgs args, string name)
    {
        Console.WriteLine($"{args.Message}");
    }
}